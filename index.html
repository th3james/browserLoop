<!doctype html>
<html>
  <head>
    <title>BackboneDiorama</title>
    <style type="text/css">
      ul {
        list-style-type: none;
        padding-left: 0;
      }
      #tracks > li {
        float:left;
        border: 1px solid #ccc;
        padding: 1px;
        width: 150px;
      }
      #tracks > li h3 {
        background-color: #33FF33;
        margin: 0;
      }
      .loops li {
        text-align: center;
      }
      .loops li h4 {
        margin: 5px;
      }
      .loops li button {
        width: 100px;
        height: 50px;
        font-size: 30px;
      }
    </style>
    <script src="js/lib/jquery-1.8.3.min.js"></script>
    <script src="js/lib/json2.js"></script>
    <script src="js/lib/underscore-min.js"></script>
    <script src="js/lib/backbone-min.js"></script>
    <script src="js/lib/html5slider.js"></script>

    <script src="js/lib/diorama.js"></script>

    <script src="js/application.js"></script>
    <script type="text/javascript">
      window.LOOP_OVERLAP_MS = 43;

      // TODO Temporary app init code to go here
      $(document).ready(function(){
        // Add the loops

        var effectsLoopCollection = new Backbone.Collections.LoopCollection([
          {name: 'Looping noise', loopUrl: 'audio/ElectricSea-JamesLoopNoise.mp3'}
        ]);
        var effects = new Backbone.Views.TrackView({name: 'Effects', collection: effectsLoopCollection});
        $('#tracks').append(effects.el);

        var jamesGuitarLoopCollection = new Backbone.Collections.LoopCollection([
          {name: 'James Chords', loopUrl: 'audio/ElectricSea-JamesChordsMain.mp3'}
        ]);
        var james = new Backbone.Views.TrackView({name: 'James Guitar', collection: jamesGuitarLoopCollection});
        $('#tracks').append(james.el);

        var drumsLoopCollection = new Backbone.Collections.LoopCollection([
          {name: 'Drums', loopUrl: 'audio/ElectricSea-DrumLoop.mp3'}
        ]);
        var drums = new Backbone.Views.TrackView({name: 'Drums', collection: drumsLoopCollection});
        $('#tracks').append(drums.el);

        var keysLoopCollection = new Backbone.Collections.LoopCollection([
          {name: 'Basic Keys', loopUrl: 'audio/ElectricSea-BasicKeys.mp3'},
          {name: 'Outro Keys', loopUrl: 'audio/ElectricSea-KeysOutro.mp3'}
        ]);
        var keys = new Backbone.Views.TrackView({name: 'Keyboard', collection: keysLoopCollection});
        $('#tracks').append(keys.el);

        var bassLoopCollection = new Backbone.Collections.LoopCollection([
          {name: 'Mike Bass', loopUrl: 'audio/ElectricSea-MikeBass.mp3'},
          {name: 'Bass Fattened', loopUrl: 'audio/ElectricSea-BassFattened.mp3'}
        ]);
        var bass = new Backbone.Views.TrackView({name: 'Bass', collection: bassLoopCollection});
        $('#tracks').append(bass.el);

        var robGuitarCollection = new Backbone.Collections.LoopCollection([
          {name: 'Rob Guitar', loopUrl: 'audio/ElectricSea-RobGuitar.mp3'}
        ]);
        var rob = new Backbone.Views.TrackView({name: 'Rob Guitar', collection: robGuitarCollection});
        $('#tracks').append(rob.el);


        // Start the clock
        theClock = new Clock();
        theClock.play();

        $('#loop-overlay').val(window.LOOP_OVERLAP_MS);
        $('#loop-overlay-amount').html(window.LOOP_OVERLAP_MS);
        $('#loop-overlay').on('change', function(e){
          window.LOOP_OVERLAP_MS = $(e.target).val();
          $('#loop-overlay-amount').html(window.LOOP_OVERLAP_MS);
        });
      });
    </script>
  </head>
  <body>
    <h1>Browser Loop!</h1>
    <p>Audio not looping smoothly? Adjust the overlay to taste.</p>
    <input id='loop-overlay' type='range' min='0' max='200'/>
    <span id='loop-overlay-amount'></span>ms
    <ul id='tracks'>
    </ul>
  </body>
</html>
