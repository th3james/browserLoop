<!doctype html>
<html>
  <head>
    <title>Browser Loop</title>
    <link charset="utf-8" rel="stylesheet" type="text/css" href="css/style.css" />
    <link href='http://fonts.googleapis.com/css?family=Julius+Sans+One|Merriweather+Sans|Oxygen' rel='stylesheet' type='text/css'>

    <script src="js/lib/jquery-1.9.1.min.js"></script>
    <script src="js/lib/json2.js"></script>
    <script src="js/lib/underscore-min.js"></script>
    <script src="js/lib/backbone-min.js"></script>
    <script src="js/lib/handlebars.js"></script>

    <script src="js/lib/html5slider.js"></script>

    <script src="js/lib/diorama.js"></script>

    <script src="js/application.js"></script>
    <script type="text/javascript">
      window.LOOP_OVERLAP_MS = 43;

      $(document).ready(function(){
        // Add the loops

        var drumsLoopCollection = new Backbone.Collections.LoopCollection([
          {name: 'Verse', length: 2, fileName: 'XEVerseDrums'},
          {space: true},
          {name: 'Chorus', fileName: 'XEChorusDrums'},
          {name: 'Middle 8', fileName: 'XEMidDrums'}
        ]);
        var drums = new Backbone.Views.TrackView({name: 'Drums', collection: drumsLoopCollection});
        $('#tracks').append(drums.el);

        var jamesGuitarLoopCollection = new Backbone.Collections.LoopCollection([
          {name: 'Verse', length: 2, fileName: 'XEVrs1James'},
          {name: 'Verse 2', length: 2, fileName: 'XEVrs2James'},
          {name: 'Chorus', length: 2, fileName: 'XEChorusJames'},
          {name: 'Middle 8', length: 2, fileName: 'XEMidJames'}
        ]);
        var james = new Backbone.Views.TrackView({name: 'Guitar 1', collection: jamesGuitarLoopCollection});
        $('#tracks').append(james.el);

        var keysLoopCollection = new Backbone.Collections.LoopCollection([
          {space: true},
          {name: 'Noise', length: 8, fileName: 'XE2ndVerseNoise'},
          {name: 'Chorus', fileName: 'XEChorusKeys'},
          {name: 'Glass', length: 2, fileName: 'XEGlassSmash'},
        ]);
        var keys = new Backbone.Views.TrackView({name: 'Synth', collection: keysLoopCollection});
        $('#tracks').append(keys.el);

        var bassLoopCollection = new Backbone.Collections.LoopCollection([
          {name: 'Verse', length: 16, fileName: 'XEVerseBass'},
          {space: true},
          {name: 'Chorus', length: 16, fileName: 'XEChorusBass'},
          {name: 'Middle8', length: 2, fileName: 'XEMidBass'}
        ]);
        var bass = new Backbone.Views.TrackView({name: 'Bass', collection: bassLoopCollection});
        $('#tracks').append(bass.el);

        var robGuitarCollection = new Backbone.Collections.LoopCollection([
          {name: 'Verse', length: 8, fileName: 'XEVrsRob'},
          {space: true},
          {name: 'Chorus', length: 8, fileName: 'XEChorusRob'},
          {name: 'Chorus 2', length: 8, fileName: 'XEChorusRob3'},
          {name: 'Middle 8', length: 2, fileName: 'XERobMidNoise'}
        ]);
        var rob = new Backbone.Views.TrackView({name: 'Guitar 2', collection: robGuitarCollection});
        $('#tracks').append(rob.el);

        var voxCollection = new Backbone.Collections.LoopCollection([
          {name: 'Verse 1', length: 16, fileName: 'XEVrs1Vox'},
          {name: 'Verse 2', length: 16, fileName: 'XEVrs2Vox'},
          {name: 'Chorus', length: 16, fileName: 'XEChorusVox'},
          {name: 'Verse 3', length: 16, fileName: 'XEVrs3Vox'},
          {name: 'Verse 4', length: 16, fileName: 'XEVrs4Vox'}
        ]);
        var vox = new Backbone.Views.TrackView({name: 'Vocals', collection: voxCollection});
        $('#tracks').append(vox.el);

        // Start the clock
        theClock = new Clock();
        theClock.play();

        $('#loop-overlay').val(window.LOOP_OVERLAP_MS);
        $('#loop-overlay-amount').html(window.LOOP_OVERLAP_MS);
        $('#loop-overlay').on('change', window.updateOverlay);

        buildSomeSceneViews(5);

        $('#stop-all').click(stopAllClips);

        if (isMobileBrowser()) {
          $('#messages').slideDown()
        }
      });
    </script>

    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-20315709-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  </head>
  <body>
    <div id='header'>
      <h2>BARCODE<br/>CHANNEL</h2>
      <h1>CROSSEYED</h1>
    </div>
    <ul id='tracks' class="green-border-box">
    </ul>
    <ul id='scenes' class='loops'>
      <li id="stop-area">
        <button id='stop-all' class='play'><img src='img/stop-button.png'/></button>
        <h4>Stop all clips</h4>
      </li>
    </ul>
    <div id='overlay-controls'>
      <p>Audio not looping smoothly? Adjust the overlay to taste.</p>
      <input id='loop-overlay' type='range' min='0' max='200'/>
      <span id='loop-overlay-amount'></span>ms
    </div>
    <div id='messages'>
      <div id='disabler'>
      </div>
      <div id='mobile-device-warning' class="green-border-box">
        <h2>Hi there, sorry about this..</h2>
        <p>We've got a really cool toy we wanted to show you where you can remix our new single in your browser. Unfortunately, mobile devices don't currently support the clever bits it needs to work.</p>
        <p>If you can, give this site a go on a desktop computer (we promise it's worth it!).</p>
        <p><a href="http://barcodechannel.com">Go to BarcodeChannel.com instead</a></p>
      </div>
    </div>
  </body>
</html>
