var fdSlider=function(){function P(e){function pt(e){e=!!e,e!=st&&(st=e,qt(jt()))}function dt(){if(!a||l=="select")return;var e=C(t);if(e.min==c&&e.max==h&&e.step==S)return;c=+e.min,h=+e.max,p=c,w=h,S=+e.step,E=Math.abs(h-c),x=S*2,N=Math.ceil(E/S),st=!1,Jt(c,h)}function vt(e){if(u&&!e)return;try{en(lt,-1),v(lt,"focus",wt),v(lt,"blur",Et),f?v(lt,"keypress",Tt):(v(lt,"keydown",Tt),v(lt,"keypress",xt)),v(ut,"mouseover",Nt),v(ut,"mouseout",Ct),v(ut,"mousedown",kt),v(ut,"touchstart",kt),n&&(window.addEventListener&&!window.devicePixelRatio?window.removeEventListener("DOMMouseScroll",St,!1):(v(document,"mousewheel",St),v(window,"mousewheel",St)))}catch(r){}b(at,"fd-slider-focused"),b(at,"fd-slider-active"),y(at,"fd-slider-disabled"),ut.setAttribute("aria-disabled",!0),t.disabled=u=!0,clearTimeout(R),e||bt("disable")}function mt(e){if(!u&&!e)return;en(lt,0),d(lt,"focus",wt),d(lt,"blur",Et),f?d(lt,"keypress",Tt):(d(lt,"keydown",Tt),d(lt,"keypress",xt)),d(ut,"touchstart",kt),d(ut,"mousedown",kt),d(ut,"mouseover",Nt),d(ut,"mouseout",Ct),b(at,"fd-slider-disabled"),ut.setAttribute("aria-disabled",!1),t.disabled=u=ot=!1,e||bt("enable")}function gt(){clearTimeout(R),ft=ht=lt=ut=at=R=null,bt("destroy"),M=null}function yt(){_t();try{var e=ut.offsetWidth,n=ut.offsetHeight,r=lt.offsetWidth,i=lt.offsetHeight,s=ht.offsetHeight,o=ht.offsetWidth,u=O?n-i:e-r;it=u/N,et=Math.max(k?Wt(zt(p)):Math.abs((p-c)/S)*it,0),Z=Math.min(k?Wt(zt(w)):Math.abs((w-c)/S)*it,Math.floor(O?n-i:e-r)),X=e,W=n,qt(B?jt():l=="select"?t.selectedIndex:parseFloat(t.value),!1)}catch(a){}bt("redraw")}function bt(e){if(!D){if(M.hasOwnProperty(e)){var n={userSet:st,disabled:u,elem:t,value:l=="select"?t.options[t.selectedIndex].value:t.value};for(var r=0,i;i=M[e][r];r++)i.call(t,n)}}else if(e.match(/^(blur|focus|change)$/i)){var s;if(typeof document.createEvent!="undefined")s=document.createEvent("HTMLEvents"),s.initEvent(e,!0,!0),t.dispatchEvent(s);else if(typeof document.createEventObject!="undefined")try{s=document.createEventObject(),t.fireEvent("on"+e.toLowerCase(),s)}catch(o){}}}function wt(e){return y(at,"fd-slider-focused"),s.onfocus&&(st=!0,qt(jt())),n&&(d(window,"DOMMouseScroll",St),d(document,"mousewheel",St),f||d(window,"mousewheel",St)),bt("focus"),!0}function Et(e){b(at,"fd-slider-focused"),n&&(v(document,"mousewheel",St),v(window,"DOMMouseScroll",St),f||v(window,"mousewheel",St)),U=!0,bt("blur")}function St(e){if(!U)return;e=e||window.event;var t=0,n;e.wheelDelta?(t=e.wheelDelta/120,f&&window.opera.version()<9.2&&(t=-t)):e.detail&&(t=-e.detail/3),O&&(t=-t),t&&(n=jt(),n+=t<0?-S:S,st=!0,qt(Ft(n))),g(e)}function xt(e){return e=e||window.event,e.keyCode>=33&&e.keyCode<=40||!U||e.keyCode==45||e.keyCode==46?m(e):!0}function Tt(e){if(!U)return!0;e=e||window.event;var t=e.keyCode!==null?e.keyCode:e.charCode,n;if(t<33||t>40&&t!=45&&t!=46)return!0;n=jt(),t==37||t==40||t==46||t==34?n-=e.ctrlKey||t==34?+x:+S:t==39||t==38||t==45||t==33?n+=e.ctrlKey||t==33?+x:+S:t==35?n=w:t==36&&(n=p),st=!0,qt(Ft(n)),bt("update"),g(e)}function Nt(e){y(at,"fd-slider-hover")}function Ct(e){b(at,"fd-slider-hover")}function kt(e){e=e||window.event,g(e);var t;e.target?t=e.target:e.srcElement&&(t=e.srcElement),t&&t.nodeType==3&&(t=t.parentNode);if(e.touches){if(e.targetTouches&&e.targetTouches.length!=1)return!1;e=e.touches[0],ot=!0}clearTimeout(R),R=null,U=!1,st=!0;if(t.className.search("fd-slider-handle")!=-1)rt=O?e.clientY:e.clientX,tt=parseInt(O?lt.offsetTop:lt.offsetLeft)||0,Ot(e),ot?(d(document,"touchmove",Ot),d(document,"touchend",At),v(ut,"mousedown",kt)):(d(document,"mousemove",Ot),d(document,"mouseup",At)),y(at,"fd-slider-active"),y(document.body,"fd-slider-drag-"+(O?"vertical":"horizontal")),bt("dragstart");else{_t();var n=0;if(e.pageX||e.pageY)n=O?e.pageY:e.pageX;else if(e.clientX||e.clientY)n=O?e.clientY+document.body.scrollTop+document.documentElement.scrollTop:e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;n-=O?Y+Math.round(lt.offsetHeight/2):G+Math.round(lt.offsetWidth/2),n=Rt(n),A=="tween"?(y(at,"fd-slider-active"),Ht(n)):A=="timed"?(y(at,"fd-slider-active"),d(document,ot?"touchend":"mouseup",Lt),nt=n,Dt()):It(n)}return!1}function Lt(e){return e=e||window.event,g(e),v(document,ot?"touchend":"mouseup",Lt),b(at,"fd-slider-active"),clearTimeout(R),R=null,U=!0,!1}function At(e){return e=e||window.event,g(e),ot?(v(document,"touchmove",Ot),v(document,"touchend",At)):(v(document,"mousemove",Ot),v(document,"mouseup",At)),U=!0,b(document.body,"fd-slider-drag-"+(O?"vertical":"horizontal")),b(at,"fd-slider-active"),bt("dragend"),!1}function Ot(e){e=e||window.event,g(e);if(e.touches){if(e.targetTouches&&e.targetTouches.length!=1)return!1;e=e.touches[0]}return It(Rt(tt+(O?e.clientY-rt:e.clientX-rt))),!1}function Mt(e){var t=jt();st=!0,t+=e*S,qt(Ft(t))}function _t(){var e=0,t=0,n=ut;try{do e+=n.offsetLeft,t+=n.offsetTop;while(n=n.offsetParent)}catch(r){}G=e,Y=t}function Dt(){var e=parseInt(O?lt.offsetTop:lt.offsetLeft,10);e=Math.round(nt<e?Math.max(nt,Math.floor(e-it)):Math.min(nt,Math.ceil(e+it))),It(Rt(e)),e!=nt?R=setTimeout(Dt,N>20?50:100):(U=!0,b(at,"fd-slider-active"),bt("finalise"))}function Ht(e){U=!1,V=parseInt(e,10),$=parseInt(O?lt.offsetTop:lt.offsetLeft,10),J=V-$,K=20,Q=0,R||(R=setTimeout(Pt,20))}function Bt(e){return isNaN(e)||e===""||typeof e=="undefined"?(st=!1,P):e<Math.min(p,w)?(st=!1,Math.min(p,w)):e>Math.max(p,w)?(st=!1,Math.max(p,w)):(st=!0,e)}function jt(){return Ft(l=="input"?parseFloat(t.value):t.selectedIndex)}function Ft(e){return isNaN(e)||e===""||typeof e=="undefined"?P:Math.min(Math.max(e,Math.min(p,w)),Math.max(p,w))}function It(e){var t=Ft(k?Ut(Xt(e)):O?h-Math.round(e/it)*S:c+Math.round(e/it)*S);lt.style[O?"top":"left"]=(e||0)+"px",Kt(),Vt(l=="select"||S==1?Math.round(t):t)}function qt(e,t){var n=!1,r;(typeof e=="undefined"||isNaN(e)||e==="")&&l=="input"&&!B?(r=P,n=!0,st=!1):r=Bt(e),lt.style[O?"top":"left"]=(k?Wt(zt(r)):O?Math.round((h-r)/S*it):Math.round((r-c)/S*it))+"px",Kt(),typeof t!==!1&&Vt(n?"":r)}function Rt(e){if(k)return Math.max(Math.min(Z,e),et);var t=e%it;return t&&t>=it/2?e+=it-t:e-=t,e<Math.min(Math.abs(et),Math.abs(Z))?e=Math.min(Math.abs(et),Math.abs(Z)):e>Math.max(Math.abs(et),Math.abs(Z))&&(e=Math.max(Math.abs(et),Math.abs(Z))),Math.min(Math.max(e,0),Z)}function Ut(e){var t=0,n=c,r;for(var i in k){if(!k.hasOwnProperty(i))continue;e>=t&&e<=+i&&(r=n+(e-t)*(+k[i]-n)/(+i-t)),t=+i,n=+k[i]}return r}function zt(e){var t=0,n=c,r=0;for(var i in k){if(!k.hasOwnProperty(i))continue;e>=n&&e<=+k[i]&&(r=t+(e-n)*(+i-t)/(+k[i]-n)),t=+i,n=+k[i]}return r}function Wt(e){return(ut[O?"offsetHeight":"offsetWidth"]-lt[O?"offsetHeight":"offsetWidth"])/100*e}function Xt(e){return e/((ut[O?"offsetHeight":"offsetWidth"]-ut[lt?"offsetHeight":"offsetWidth"])/100)}function Vt(e){bt("update"),st?b(at,"fd-slider-no-value"):y(at,"fd-slider-no-value");if(l=="select")try{e=parseInt(e,10);if(t.selectedIndex===e){Gt();return}t.options[e].selected=!0}catch(n){}else{e!==""&&!q&&(console.log("val:"+e+", min:"+c+", max:"+h+", step:"+S),e=(c+Math.round((+e-c)/S)*S).toFixed(T));if(t.value===e){Gt();return}t.value=e}Gt(),bt("change")}function $t(e){return!(isNaN(e)||e===""||e<Math.min(p,w)||e>Math.max(p,w))}function Jt(e,n){p>w?(e=Math.min(c,Math.max(e,n)),n=Math.max(h,Math.min(e,n)),p=Math.max(e,n),w=Math.min(e,n)):(e=Math.max(c,Math.min(e,n)),n=Math.min(h,Math.max(e,n)),p=Math.min(e,n),w=Math.max(e,n)),P<Math.min(p,w)?P=Math.min(p,w):P>Math.max(p,w)&&(P=Math.max(p,w)),lt.setAttribute("aria-valuemin",p),lt.setAttribute("aria-valuemax",w),Bt(l=="input"?parseFloat(t.value):t.selectedIndex),yt()}function Kt(){if(o)return;O?ct.style.height=Math.max(1,ht.offsetHeight-lt.offsetTop)+"px":ct.style.width=Math.max(1,lt.offsetLeft)+"px"}function Qt(){var e=!1,n=document.getElementsByTagName("label");for(var r=0,i;i=n[r];r++)if(i.htmlFor&&i.htmlFor==t.id||i.getAttribute("for")==t.id){e=i;break}return e&&!e.id&&(e.id=t.id+"_label"),e}function Gt(){var e=l=="select"?t.options[t.selectedIndex].value:t.value,n=F?F(e):l=="select"?t.options[t.selectedIndex].text?t.options[t.selectedIndex].text:e:e;lt.setAttribute("aria-valuenow",e),lt.setAttribute("aria-valuetext",n)}function Yt(e){st=!0,q=I,qt(l=="input"?parseFloat(t.value):t.selectedIndex),Gt(),q=!1}function Zt(e){l=="input"?t.value=t.defaultValue:t.selectedIndex=H,Bt(l=="select"?t.options[t.selectedIndex].value:t.value),yt(),Gt()}function pt(e){st=!!e}function en(e,t){e.setAttribute("tabIndex",t),e.tabIndex=t}var t=e.inp,u=!1,l=t.tagName.toLowerCase(),c=+e.min,h=+e.max,p=+e.min,w=+e.max,E=Math.abs(h-c),S=l=="select"?1:+e.step,x=e.maxStep?+e.maxStep:S*2,T=e.precision||0,N=Math.ceil(E/S),k=e.scale||!1,L=!!e.hideInput,A=e.animation||"",O=!!e.vertical,M=e.callbacks||{},_=e.classNames||"",D=!!e.html5Shim,P=h<c?c:c+(h-c)/2,H=l=="select"?t.selectedIndex:t.defaultValue||P,B=D||!!e.forceValue,j=D&&O&&"inpHeight"in e?e.inpHeight:!1,F=!D&&e.ariaFormat?e.ariaFormat:!1,I=!D&&l!="select"&&"userSnap"in e?!!e.userSnap:!1,q=!1,R=null,U=!0,z=l=="select"?t.selectedIndex:t.value,W=0,X=0,V=0,$=0,J=0,K=0,Q=0,G=0,Y=0,Z=0,et=0,tt=0,nt=0,rt=0,it=0,st=!1,ot=!1,ut,at,ft,lt,ct,ht;l=="input"&&B&&!t.defaultValue&&(t.defaultValue=jt()),h<c&&(S=-Math.abs(S),x=-Math.abs(x)),k&&(k[100]=h);var Pt=function(){Q++;var e=J,t=20,n=Q,r=$,i=Math.ceil(n==t?r+e:e*(-Math.pow(2,-10*n/t)+1)+r);It(n==t?V:i),n!=t?(bt("move"),R=setTimeout(Pt,20)):(clearTimeout(R),R=null,U=!0,b(at,"fd-slider-focused"),b(at,"fd-slider-active"),bt("finalise"))};return function(){D||L?y(t,"fd-form-element-hidden"):d(t,"change",Yt),D&&(t.setAttribute("fd-range-enabled",1),t.stepUp=function(e){Mt(e||1)},t.stepDown=function(e){Mt(e||-1)},a&&d(t,typeof t.onpropertychange=="object"?"propertychange":"DOMAttrModified",dt)),ut=document.createElement("span"),ut.className="fd-slider"+(O?"-vertical ":" ")+_,ut.id="fd-slider-"+t.id,O&&j&&(ut.style.height=j+"px"),at=document.createElement("span"),at.className="fd-slider-wrapper"+(D?"":" fd-slider-no-value"),ft=document.createElement("span"),ft.className="fd-slider-inner",ht=document.createElement("span"),ht.className="fd-slider-bar",r?lt=document.createElement("span"):(lt=document.createElement("a"),lt.setAttribute("href","#"),d(lt,"click",m)),en(lt,0),lt.className="fd-slider-handle",lt.appendChild(document.createTextNode(String.fromCharCode(160))),at.appendChild(ft),o||(ct=document.createElement("span"),ct.className="fd-slider-range",at.appendChild(ct)),at.appendChild(ht),at.appendChild(lt),ut.appendChild(at),t.parentNode.insertBefore(ut,t);if(f||!1)lt.unselectable="on",ht.unselectable="on",ft.unselectable="on",ut.unselectable="on",at.unselectable="on",o||(ct.unselectable="on");ut.setAttribute("role","application"),lt.setAttribute("role","slider"),lt.setAttribute("aria-valuemin",l=="select"?t.options[0].value:c),lt.setAttribute("aria-valuemax",l=="select"?t.options[t.options.length-1].value:h);var e=Qt();e&&(lt.setAttribute("aria-labelledby",e.id),lt.id="fd-slider-handle-"+t.id,e.setAttribute("for",lt.id)),document.getElementById(i)&&lt.setAttribute("aria-describedby",i),t.getAttribute("disabled")==1||t.getAttribute("disabled")=="disabled"?vt(!0):mt(!0),s.onvalue&&(st=!0,Bt(l=="input"?parseFloat(t.value):t.selectedIndex)),t.form&&d(t.form,"reset",Zt),Gt(),bt("create"),yt()}(),{onResize:function(e){(ut.offsetHeight!=W||ut.offsetWidth!=X)&&yt()},destroy:function(){gt()},reset:function(){qt(l=="input"?parseFloat(t.value):t.selectedIndex)},stepUp:function(e){Mt(Math.abs(e)||1)},stepDown:function(e){Mt(-Math.abs(e)||-1)},increment:function(e){Mt(e)},disable:function(){vt()},enable:function(){mt()},setRange:function(e,t){Jt(e,t)},getValueSet:function(){return!!st},setValueSet:function(e){pt(e)},rescan:function(){dt()},checkValue:function(){s.onvalue&&(st=!0,Bt(l=="input"?parseFloat(t.value):t.selectedIndex)),Gt(),yt()}}}var e={},t=0,n=!0,r=!0,i="fd-slider-describedby",s={onfocus:!0,onvalue:!0},o=!1,u="jump",a=!1,f=Object.prototype.toString.call(window.opera)==="[object Opera]",l=/^([\-]{0,1}[0-9]+(\.[0-9]+){0,1})$/,c=/^([0-9]+(\.[0-9]+){0,1})$/,h=function(e){if(typeof e!="string"||e==="")return{};try{if(typeof JSON=="object"&&typeof JSON.parse=="function")return JSON.parse(e);if(/mousewheelenabled|fullaria|describedby|norangebar|html5animation|varsetrules/.test(e.toLowerCase())){var t=Function(["var document,top,self,window,parent,Number,Date,Object,Function,","Array,String,Math,RegExp,Image,ActiveXObject;","return (",e.replace(/<\!--.+-->/gim,"").replace(/\bfunction\b/g,"function-"),");"].join(""));return t()}}catch(n){}return{err:"Could not parse the JSON object"}},p=function(e){if(typeof e!="object")return;for(var t in e){value=e[t];switch(t.toLowerCase()){case"mousewheelenabled":n=!!value;break;case"fullaria":r=!!value;break;case"describedby":i=String(value);break;case"norangebar":o=!!value;break;case"html5animation":u=String(value).search(/^(jump|tween|timed)$/i)!=-1?String(value).toLowerCase():"jump";break;case"watchattributes":a=!!value;break;case"varsetrules":"onfocus"in value&&(s.onfocus=!!value.onfocus),"onvalue"in value&&(s.onvalue=!!value.onvalue)}}},d=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!0):e.attachEvent&&e.attachEvent("on"+t,n)},v=function(e,t,n){try{e.removeEventListener?e.removeEventListener(t,n,!0):e.detachEvent&&e.detachEvent("on"+t,n)}catch(r){}},m=function(e){return e=e||window.event,e.stopPropagation&&(e.stopPropagation(),e.preventDefault()),!1},g=function(e){e=e||window.event;if(e.preventDefault){e.preventDefault();return}e.returnValue=!1},y=function(e,t){if((new RegExp("(^|\\s)"+t+"(\\s|$)")).test(e.className))return;e.className+=(e.className?" ":"")+t},b=function(e,t){e.className=t?e.className.replace(new RegExp("(^|\\s)"+t+"(\\s|$)")," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""):""},w=function(){var t={};for(var n in e)t[n]=e[n].getValueSet();return t},E=function(t,n){e[t].setValueSet(!!n)},S=function(t){return!!(t in e&&e.hasOwnProperty(t))},x=function(t){if(!t||!t.inp||!t.inp.tagName||t.inp.tagName.search(/^input|select/i)==-1)return!1;t.html5Shim=!1;if(t.inp.tagName.toLowerCase()=="select"){if(t.inp.options.length<2)return!1;t.min=0,t.max=t.inp.options.length-1,t.step=1,t.precision=0,t.scale=!1,t.forceValue=!0}else{if(String(t.inp.type).search(/^(text|range)$/i)==-1)return!1;t.min=t.min&&String(t.min).search(l)!=-1?+t.min:0,t.max=t.max&&String(t.max).search(l)!=-1?+t.max:100,t.step=t.step&&String(t.step).search(c)!=-1?t.step:1,t.precision=t.precision&&String(t.precision).search(/^[0-9]+$/)!=-1?t.precision:String(t.step).search(/\.([0-9]+)$/)!=-1?String(t.step).match(/\.([0-9]+)$/)[1].length:0,t.scale=t.scale||!1,t.forceValue="forceValue"in t?!!t.forceValue:!1,t.userSnap="userSnap"in t?!!t.userSnap:!1}return t.ariaFormat="ariaFormat"in t&&typeof t.ariaFormat=="function"?t.ariaFormat:!1,t.maxStep=t.maxStep&&String(t.maxStep).search(c)!=-1?+t.maxStep:+t.step*2,t.classNames=t.classNames||"",t.callbacks=t.callbacks||!1,k(t.inp.id),e[t.inp.id]=new P(t),!0},T=function(e,t){return e.getAttribute(t)||""},N=function(){var n=document.getElementsByTagName("input"),r,i;for(var s=0,o;o=n[s];s++)if(o.tagName.toLowerCase()=="input"&&T(o,"type")&&T(o,"type").toLowerCase()=="range"&&(T(o,"min")&&T(o,"min").search(l)!=-1||T(o,"max")&&T(o,"max").search(l)!=-1||T(o,"step")&&T(o,"step").search(/^(any|([0-9]+(\.[0-9]+){0,1}))$/i)!=-1)){if(o.id&&document.getElementById("fd-slider-"+o.id))continue;o.id&&!document.getElementById("fd-slider-"+o.id)&&k(o.id),o.id||(o.id="fd-slider-form-elem-"+t++),r={inp:o,callbacks:[],animation:u,vertical:T(o,"data-fd-slider-vertical")?!0:o.offsetHeight>o.offsetWidth,classNames:T(o,"data-fd-slider-vertical"),html5Shim:!0},r.vertical&&!T(o,"data-fd-slider-vertical")&&(r.inpHeight=o.offsetHeight),i=C(o),r.min=i.min,r.max=i.max,r.step=i.step,r.precision=String(r.step).search(/\.([0-9]+)$/)!=-1?String(r.step).match(/\.([0-9]+)$/)[1].length:0,r.maxStep=r.step*2,k(r.inp.id),e[r.inp.id]=new P(r)}return!0},C=function(e){return{min:+(T(e,"min")||0),max:+(T(e,"max")||100),step:+(T(e,"step").search(c)!=-1?e.getAttribute("step"):1)}},k=function(t){return t in e&&e.hasOwnProperty(t)?(e[t].destroy(),delete e[t],!0):!1},L=function(t){for(var n in e)e.hasOwnProperty(n)&&e[n].destroy();e=[]},A=function(t){L(),e=null},O=function(t){for(var n in e)e.hasOwnProperty(n)&&e[n].onResize()},M=function(){for(var t in e)e.hasOwnProperty(t)&&e[t].rescan()},_=function(){D(),N()},D=function(){v(window,"load",N)};return d(window,"load",N),d(window,"load",function(){setTimeout(function(){var t;for(t in e)e[t].checkValue()},0)}),d(window,"resize",O),d(window,"unload",A),function(){var e=document.getElementsByTagName("script"),t=h(String(e[e.length-1].innerHTML).replace(/[\n\r\s\t]+/g," ").replace(/^\s+/,"").replace(/\s+$/,""));typeof t=="object"&&!("err"in t)&&p(t)}(),{rescanDocument:N,createSlider:function(e){return x(e)},onDomReady:function(){_()},destroyAll:function(){L()},destroySlider:function(e){return k(e)},redrawAll:function(){O()},addEvent:d,removeEvent:v,stopEvent:m,increment:function(t,n){if(!S(t))return!1;e[t].increment(n)},stepUp:function(t,n){if(!S(t))return!1;e[t].stepUp(Math.abs(n)||1)},stepDown:function(t,n){if(!S(t))return!1;e[t].stepDown(-Math.abs(n)||-1)},setRange:function(t,n,r){if(!S(t))return!1;e[t].setRange(n,r)},updateSlider:function(t){if(!S(t))return!1;e[t].onResize(),e[t].reset()},disable:function(t){if(!S(t))return!1;e[t].disable()},enable:function(t){if(!S(t))return!1;e[t].enable()},getValueSet:function(){return w()},setValueSet:function(e,t){if(!S(id))return!1;E(e,t)},setGlobalVariables:function(e){p(e)},removeOnload:function(){D()},rescanAttributes:M}}();(function(){var e,t,n,r=[].slice,i=function(e,t){return function(){return e.apply(t,arguments)}},s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};(e=window.Backbone).Diorama||(e.Diorama={}),Backbone.Diorama.Controller=function(){function e(){}return _.extend(e.prototype,Backbone.Events),e.prototype.changeStateOn=function(){var e,t,n,i,s,o,u=this;n=1<=arguments.length?r.call(arguments,0):[],this.stateEventBindings||(this.stateEventBindings=[]),o=[];for(i=0,s=n.length;i<s;i++)t=n[i],e=function(){var e;return e=t.newState,function(){return u.transitionToState(e,arguments)}}(),t.publisher.on(t.event,e),o.push(this.stateEventBindings.push({publisher:t.publisher,event:t.event,transition:e}));return o},e.prototype.clearStateEventBindings=function(){return _.each(this.stateEventBindings,function(e){return e.publisher.off(e.event,e.transition)}),this.stateEventBindings=[]},e.prototype.transitionToState=function(e,t){return this.clearStateEventBindings(),e.apply(this,t)},e}(),(t=window.Backbone).Diorama||(t.Diorama={}),Backbone.Diorama.ManagedRegion=function(){function e(e){this.tagName=(e!=null?e.tagName:void 0)||"div",this.$el=$("<"+this.tagName+">")}return e.prototype.showView=function(e){return this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.render(),this.$el.html(this.currentView.el)},e.prototype.isEmpty=function(){return this.$el.is(":empty")},e}(),_.extend(Backbone.View.prototype,{bindTo:function(e,t,n){return e.bind(t,n,this),this.bindings==null&&(this.bindings=[]),this.bindings.push({model:e,ev:t,callback:n})},unbindFromAll:function(){return this.bindings!=null&&_.each(this.bindings,function(e){return e.model.unbind(e.ev,e.callback)}),this.bindings=[]},close:function(){this.unbindFromAll(),this.unbind(),this.remove();if(this.onClose)return this.onClose()}}),window.Backbone||(window.Backbone={}),(n=window.Backbone).Views||(n.Views={}),Backbone.Diorama.NestingView=function(e){function t(){this.addSubViewTo=i(this.addSubViewTo,this),Handlebars.registerHelper("addSubViewTo",this.addSubViewTo),t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.addSubViewTo=function(e,t,n){return this.addSubView.call(e,t,n)},t.prototype.addSubView=function(e,t){var n,r,i;return i=t.hash||{},n=Backbone.Views[e],r=new n(i),this.subViews||(this.subViews=[]),this.subViews.push(r),this.generateSubViewPlaceholderTag(r)},t.prototype.generateSubViewPlaceholderTag=function(e){var t;return t="<"+e.tagName+' data-sub-view-cid="'+e.cid+'"></'+e.tagName+">",new Handlebars.SafeString(t)},t.prototype.renderSubViews=function(){var e,t,n,r,i;if(this.subViews!=null){r=this.subViews,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],e.setElement(this.$el.find('[data-sub-view-cid="'+e.cid+'"]')),i.push(e.render());return i}},t.prototype.closeSubViews=function(){var e,t,n,r;if(this.subViews!=null){r=this.subViews;for(t=0,n=r.length;t<n;t++)e=r[t],e.onClose(),e.close()}return this.subViews=[]},t}(Backbone.View)}).call(this),!function(){var e=Handlebars.template,t=Handlebars.templates=Handlebars.templates||{};t["track.hbs"]=e(function(e,t,n,r,i){function s(e,t,r){var i,s,a="";return a+="\n    ",s=n["if"].call(e,(i=e.attributes,null==i||i===!1?i:i.space),{hash:{},inverse:h.programWithDepth(4,u,t,r),fn:h.program(2,o,t),data:t}),(s||0===s)&&(a+=s),a+="\n  "}function o(){return"\n      <li></li>\n    "}function u(e,t,r){var i,s,o="";return o+="\n      ",s={hash:{model:e},data:t},o+=c((i=n.addSubViewTo||e.addSubViewTo,i?i.call(e,r.thisView,"LoopView",s):l.call(e,"addSubViewTo",r.thisView,"LoopView",s)))+"\n    "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var a,f="",l=n.helperMissing,c=this.escapeExpression,h=this,p="function";return f+="<h3>",(a=n.name)?a=a.call(t,{hash:{},data:i}):(a=t.name,a=typeof a===p?a.apply(t):a),f+=c(a)+"</h3>\n<div class='volume-strip'>\n  <input class='volume' type='range' min='0' max='100'/>\n  <img src='img/sound_low.png'/>\n  <img class='right' src='img/sound_high.png'/>\n</div>\n<ul class='loops'>\n  ",a=n.each.call(t,t.loops,{hash:{},inverse:h.noop,fn:h.programWithDepth(1,s,i,t),data:i}),(a||0===a)&&(f+=a),f+="\n</ul>\n"}),t["loop.hbs"]=e(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="",u="function",a=this.escapeExpression;return o+='<audio data-role="first" src="',(s=n.loopUrl)?s=s.call(t,{hash:{},data:i}):(s=t.loopUrl,s=typeof s===u?s.apply(t):s),o+=a(s)+'">\n  <p>Your browser does not support the audio element.</p>\n</audio>\n<audio data-role="buffer" src="',(s=n.loopUrl)?s=s.call(t,{hash:{},data:i}):(s=t.loopUrl,s=typeof s===u?s.apply(t):s),o+=a(s)+"\">\n  <p>Your browser does not support the audio element.</p>\n</audio>\n<div class='controls'></div>\n<h4>",(s=n.name)?s=s.call(t,{hash:{},data:i}):(s=t.name,s=typeof s===u?s.apply(t):s),o+=a(s)+"</h4>\n"}),t["loop-controls.hbs"]=e(function(e,t,n,r,i){function s(){return"\n  <button class='stop'><img src='img/stop-button.png'/></button>\n"}function o(){return"\n  <button class='play'><img src='img/play-button.png'/></button>\n"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var u,a="",f=this;return u=n["if"].call(t,t.playing,{hash:{},inverse:f.program(3,o,i),fn:f.program(1,s,i),data:i}),(u||0===u)&&(a+=u),a+="\n"}),t["scene_play.hbs"]=e(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},"<button class='play'><img src='img/play-button.png'/></button>\n"})}(),function(){var e,t,n,r,i,s,o,u,a,f,l,c,h={}.hasOwnProperty,p=function(e,t){function r(){this.constructor=e}for(var n in t)h.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},d=function(e,t){return function(){return e.apply(t,arguments)}};(t=window.Backbone).Models||(t.Models={}),window.Backbone.Models.Loop=function(e){function t(){return u=t.__super__.constructor.apply(this,arguments),u}return p(t,e),t.prototype.defaults={length:4,space:!1,playing:!1,volume:.5},t.prototype.initialize=function(e){if(e.fileName!=null)return this.setLoopUrlFromFilename(e.fileName)},t.prototype.setLoopUrlFromFilename=function(e){return(new Audio).canPlayType("audio/ogg")?(console.log("using ogg"),this.set("loopUrl","audio/ogg/"+e+".theora.oga")):(console.log("using mp3"),this.set("loopUrl","audio/mp3/"+e+".mp3"))},t}(Backbone.Model),window.Backbone||(window.Backbone={}),(n=window.Backbone).Collections||(n.Collections={}),Backbone.Collections.LoopCollection=function(e){function t(){return this.playLoop=d(this.playLoop,this),this.stopLoops=d(this.stopLoops,this),a=t.__super__.constructor.apply(this,arguments),a}return p(t,e),t.prototype.model=Backbone.Models.Loop,t.prototype.initialize=function(){return this.on("requestTrackStop",this.stopLoops),Backbone.on("playScene",this.playLoop)},t.prototype.stopLoops=function(){return this.each(function(e){return e.set("playing",!1)})},t.prototype.playLoop=function(e){var t;this.stopLoops(),t=this.models[e];if(t!=null)return t.set("playing",!0)},t}(Backbone.Collection),window.Backbone||(window.Backbone={}),(r=window.Backbone).Views||(r.Views={}),Backbone.Views.TrackView=function(e){function t(){return this.changeVolume=d(this.changeVolume,this),this.render=d(this.render,this),f=t.__super__.constructor.apply(this,arguments),f}return p(t,e),t.prototype.template=Handlebars.templates["track.hbs"],t.prototype.tagName="li",t.prototype.events={"change .volume":"changeVolume"},t.prototype.initialize=function(e){return this.loopCollection=e.collection,this.name=e.name,this.render()},t.prototype.render=function(){return this.closeSubViews(),Handlebars.registerHelper("debugger",function(e,t,n){debugger}),this.$el.html(this.template({thisView:this,name:this.name,loops:this.loopCollection.models})),this.renderSubViews(),this},t.prototype.changeVolume=function(e){return this.volume=$(e.target).val(),this.loopCollection.invoke("set",{volume:this.volume/100})},t.prototype.onClose=function(){return this.closeSubViews()},t}(Backbone.Diorama.NestingView),window.Backbone||(window.Backbone={}),(i=window.Backbone).Views||(i.Views={}),Backbone.Views.LoopView=function(e){function t(){return this.stopBuffer2=d(this.stopBuffer2,this),this.stopBuffer1=d(this.stopBuffer1,this),this.loop=d(this.loop,this),this.checkReadyToPlay=d(this.checkReadyToPlay,this),this.setVolumeFromModel=d(this.setVolumeFromModel,this),this.onPlayStateChange=d(this.onPlayStateChange,this),this.render=d(this.render,this),l=t.__super__.constructor.apply(this,arguments),l}return p(t,e),t.prototype.template=Handlebars.templates["loop.hbs"],t.prototype.controlsTemplate=Handlebars.templates["loop-controls.hbs"],t.prototype.tagName="li",t.prototype.events={"click .play":"setPlaying","click .stop":"setStopped"},t.prototype.initialize=function(e){return this.model=e.model,this.first=!0,this.isReadyToPlay=!1,this.renderedAudioTags=!1,this.model.on("change:playing",this.onPlayStateChange),this.model.on("change:volume",this.setVolumeFromModel)},t.prototype.render=function(){return this.renderedAudioTags||this.renderAudioTags(),this.renderControls(),this},t.prototype.renderAudioTags=function(){return this.$el.html(this.template(this.model.toJSON())),this.buffer1=this.$el.find("[data-role='first']")[0],this.buffer1.load(),this.buffer1.addEventListener("loadeddata",this.checkReadyToPlay),this.buffer2=this.$el.find("[data-role='buffer']")[0],this.buffer2.load(),this.buffer2.addEventListener("loadeddata",this.checkReadyToPlay),this.setVolumeFromModel(),this.renderedAudioTags=!0},t.prototype.renderControls=function(){return this.isReadyToPlay?this.$el.find(".controls").html(this.controlsTemplate({playing:this.model.get("playing")})):this.$el.find(".controls").html("<p>Loading loop...</p>")},t.prototype.onPlayStateChange=function(){if(this.model.get("playing"))return this.play()},t.prototype.setVolumeFromModel=function(){var e;return e=this.model.get("volume"),this.buffer1.volume=e,this.buffer2.volume=e},t.prototype.setPlaying=function(){return this.model.trigger("requestTrackStop"),this.model.set("playing",!0)},t.prototype.setStopped=function(){return this.model.set("playing",!1)},t.prototype.play=function(){return this.startListeningToClock(),this.render()},t.prototype.stop=function(){return this.model.set("playing",!1),this.stopListeningToClock(),this.buffer1.pause(),this.buffer2.pause(),this.render()},t.prototype.checkReadyToPlay=function(){return!this.isReadyToPlay&&this.buffer1!=null&&this.buffer2!=null&&(this.isReadyToPlay=this.buffer1.readyState>1&&this.buffer2.readyState>1),this.render(),this.isReadyToPlay},t.prototype.loop=function(e){var t;if(this.model.get("playing")===!1)return this.stop();if(this.isReadyToPlay){this.startedAtTick==null&&(this.startedAtTick=e);if(this.shouldRestartOnTick(e))return this.first?(this.buffer1.play(),t=this.stopBuffer2):(this.buffer2.play(),t=this.stopBuffer1),setTimeout(t,window.LOOP_OVERLAP_MS),this.first=!this.first}},t.prototype.stopBuffer1=function(){return this.buffer1.pause(),this.buffer1.load()},t.prototype.stopBuffer2=function(){return this.buffer2.pause(),this.buffer2.load()},t.prototype.shouldRestartOnTick=function(e){var t;return t=e-this.startedAtTick,t%this.model.get("length")===0},t.prototype.startListeningToClock=function(){return this.listening||(Backbone.on("tick",this.loop),this.listening=!0),this.startedAtTick=void 0},t.prototype.stopListeningToClock=function(){return Backbone.off("tick",this.loop),this.listening=!1},t.prototype.onClose=function(){return this.stopListeningToClock()},t}(Backbone.View),window.Backbone||(window.Backbone={}),(s=window.Backbone).Views||(s.Views={}),Backbone.Views.ScenePlayView=function(e){function t(){return c=t.__super__.constructor.apply(this,arguments),c}return p(t,e),t.prototype.template=Handlebars.templates["scene_play.hbs"],t.prototype.tagName="li",t.prototype.events={"click .play":"playScene"},t.prototype.initialize=function(e){return this.sceneNumber=e.sceneNumber,this.render()},t.prototype.render=function(){return this.$el.html(this.template()),this},t.prototype.playScene=function(){return Backbone.trigger("playScene",this.sceneNumber)},t.prototype.onClose=function(){},t}(Backbone.View),window.Clock=function(){function e(){this.play=d(this.play,this),this.ticks=0,this.loopTime=888}return e.prototype.play=function(){return Backbone.trigger("tick",this.ticks),this.ticks=this.ticks+1,setTimeout(this.play,this.loopTime)},e}(),e=function(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)},window.showUnsupportedBrowserMessages=function(){if(e())return $("#messages").slideDown(),$("#mobile-device-warning").slideDown();if(isIE)return $("#messages").slideDown(),$("#ie-warning").slideDown(),$("#ie-let-me-try").click(function(){return $("#messages").slideUp()})},window.BrowserLoop={},BrowserLoop.LOOP_OVERLAP_MS=43,BrowserLoop.buildSomeSceneViews=function(e){var t,n,r,i;e-=1,i=[];for(t=r=0;0<=e?r<=e:r>=e;t=0<=e?++r:--r)n=new Backbone.Views.ScenePlayView({sceneNumber:t}),i.push($("#scenes").append(n.el));return i},BrowserLoop.updateOverlay=function(e){return BrowserLoop.LOOP_OVERLAP_MS=$(e.target).val(),$("#loop-overlay-amount").html(BrowserLoop.LOOP_OVERLAP_MS)},BrowserLoop.stopAllClips=function(){return Backbone.trigger("playScene",-1)},BrowserLoop.createTrackViews=function(){var e,t,n,r,i,s,o,u,a,f,l,c;return r=new Backbone.Collections.LoopCollection([{name:"Verse",length:2,fileName:"XEVerseDrums"},{space:!0},{name:"Chorus",fileName:"XEChorusDrums"},{name:"Middle 8",fileName:"XEMidDrums"}]),n=new Backbone.Views.TrackView({name:"Drums",collection:r}),$("#tracks").append(n.el),s=new Backbone.Collections.LoopCollection([{name:"Verse",length:2,fileName:"XEVrs1James"},{name:"Verse 2",length:2,fileName:"XEVrs2James"},{name:"Chorus",length:2,fileName:"XEChorusJames"},{name:"Middle 8",length:2,fileName:"XEMidJames"}]),i=new Backbone.Views.TrackView({name:"Guitar 1",collection:s}),$("#tracks").append(i.el),u=new Backbone.Collections.LoopCollection([{space:!0},{name:"Noise",length:8,fileName:"XE2ndVerseNoise"},{name:"Chorus",fileName:"XEChorusKeys"},{name:"Glass",length:2,fileName:"XEGlassSmash"}]),o=new Backbone.Views.TrackView({name:"Synth",collection:u}),$("#tracks").append(o.el),t=new Backbone.Collections.LoopCollection([{name:"Verse",length:16,fileName:"XEVerseBass"},{space:!0},{name:"Chorus",length:16,fileName:"XEChorusBass"},{name:"Middle8",length:2,fileName:"XEMidBass"}]),e=new Backbone.Views.TrackView({name:"Bass",collection:t}),$("#tracks").append(e.el),f=new Backbone.Collections.LoopCollection([{name:"Verse",length:8,fileName:"XEVrsRob"},{space:!0},{name:"Chorus",length:8,fileName:"XEChorusRob"},{name:"Chorus 2",length:8,fileName:"XEChorusRob3"},{name:"Middle 8",length:2,fileName:"XERobMidNoise"}]),a=new Backbone.Views.TrackView({name:"Guitar 2",collection:f}),$("#tracks").append(a.el),c=new Backbone.Collections.LoopCollection([{name:"Verse 1",length:16,fileName:"XEVrs1Vox"},{name:"Verse 2",length:16,fileName:"XEVrs2Vox"},{name:"Chorus",length:16,fileName:"XEChorusVox"},{name:"Verse 3",length:16,fileName:"XEVrs3Vox"},{name:"Verse 4",length:16,fileName:"XEVrs4Vox"}]),l=new Backbone.Views.TrackView({name:"Vocals",collection:c}),$("#tracks").append(l.el)},window.Backbone||(window.Backbone={}),(o=window.Backbone).Controllers||(o.Controllers={}),Backbone.Controllers.MainController=function(e){function t(){BrowserLoop.createTrackViews(),BrowserLoop.buildSomeSceneViews(5),this.setupGlobalControlBindings(),this.start()}return p(t,e),t.prototype.start=function(){var e;return e=new Clock,e.play()},t.prototype.setupGlobalControlBindings=function(){return $("#loop-overlay").val(BrowserLoop.LOOP_OVERLAP_MS),$("#loop-overlay-amount").html(BrowserLoop.LOOP_OVERLAP_MS),$("#loop-overlay").on("change",BrowserLoop.updateOverlay),$("#stop-all").click(BrowserLoop.stopAllClips)},t}(Backbone.Diorama.Controller)}.call(this)